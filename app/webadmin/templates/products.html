{% extends 'base.html' %}
{% block content %}
<h1>ูุฏุฑุช ูุญุตููุงุช</h1>

<section class="panel">
    <header>
        <h2>ุงุถุงููโฺฉุฑุฏู ูุญุตูู/ุฏุณุชู ุฌุฏุฏ</h2>
        <p class="muted">ุงุฒ ุงู ุจุฎุด ูโุชูุงูุฏ ููููุง ุฑุจุงุช ุฑุง ุชุง ุจููุงุช ุณุทุญ ุจุณุงุฒุฏ.</p>
    </header>
    <form method="post" action="{{ url_for('products_create') }}" class="grid form-grid">
        <label>
            ูุงู
            <input type="text" name="title" required placeholder="ูุซูุงู ุฎุฏูุงุช ุฌุฏุฏ">
        </label>
        <label>
            ููุน
            <select name="type">
                <option value="product">ูุญุตูู/ุฎุฏูุช</option>
                <option value="category">ุฏุณุชูโุจูุฏ</option>
            </select>
        </label>
        <label>
            ูุงูุฏ
            <select name="parent_id">
                {% for p in parents %}
                <option value="{{ p.id }}">{{ p.title }}</option>
                {% endfor %}
            </select>
        </label>
        <label>
            ุชุฑุชุจ ููุงุด
            <input type="number" name="sort_order" value="0" min="0">
        </label>
        <label>
            ููุช ({{ currency }})
            <input type="number" name="price" value="0" min="0" step="1000">
        </label>
        <label class="checkbox">
            <input type="checkbox" name="available" checked>
            ููุฌูุฏ ุจุงุดุฏ
        </label>
        <label class="full">
            ุชูุถุญุงุช
            <textarea name="description" rows="2" placeholder="ุชูุถุญ ฺฉูุชุงู ุจุฑุง ุตูุญูู ูุญุตูู"></textarea>
        </label>
        <div class="form-actions">
            <button type="submit" class="btn-primary">ุงุฌุงุฏ</button>
        </div>
    </form>
</section>

<section class="panel">
    <header>
        <h2>ููุฑุณุช ฺฉุงูู ูุญุตููุงุช ู ุฏุณุชูโูุง</h2>
        <p class="muted">ููุชโูุง ุจุฑ ุญุณุจ {{ currency }} ูุณุชูุฏ. ูุฑ ุฑุฏู ูุงุจู ูุฑุงุด ูุณุชูู ุงุณุช.</p>
    </header>
    <table class="products-table">
        <thead>
            <tr>
                <th>ุนููุงู</th>
                <th>ููุน/ฺุฏูุงู</th>
                <th>ููุช ู ููุฌูุฏ</th>
                <th>ูุงูุฏ</th>
                <th>ุชูุถุญุงุช</th>
                <th>ุนููุงุช</th>
            </tr>
        </thead>
        <tbody>
            {% for item in products %}
            <tr>
                <td>
                    <div class="tree-title" style="--depth: {{ item.depth }};">
                        <span class="node-tag {{ 'category' if item.is_category else 'product' }}">{{ '๐' if item.is_category else '๐๏ธ' }}</span>
                        <input type="text" form="edit-{{ item.id }}" name="title" value="{{ item.title }}" required>
                        <div class="path muted">{{ item.path_display }}</div>
                    </div>
                </td>
                <td>
                    <div class="inline-fields">
                        <label>
                            ููุน
                            <select name="type" form="edit-{{ item.id }}">
                                <option value="product" {% if not item.is_category %}selected{% endif %}>ูุญุตูู</option>
                                <option value="category" {% if item.is_category %}selected{% endif %}>ุฏุณุชู</option>
                            </select>
                        </label>
                        <label>
                            ุชุฑุชุจ
                            <input type="number" name="sort_order" form="edit-{{ item.id }}" value="{{ item.sort_order or 0 }}" min="0">
                        </label>
                    </div>
                </td>
                <td>
                    <div class="inline-fields">
                        <label>ููุช
                            <input type="number" name="price" form="edit-{{ item.id }}" value="{{ item.price }}" min="0" step="1000" {% if item.is_category %}disabled{% endif %}>
                        </label>
                        <label class="checkbox">
                            <input type="checkbox" name="available" form="edit-{{ item.id }}" {% if item.available %}checked{% endif %} {% if item.is_category %}disabled{% endif %}>
                            ูุนุงู
                        </label>
                    </div>
                </td>
                <td>
                    <select name="parent_id" form="edit-{{ item.id }}">
                        {% for p in parents %}
                        <option value="{{ p.id }}" {% if (item.parent_id or 0) == p.id %}selected{% endif %}>{{ p.title }}</option>
                        {% endfor %}
                    </select>
                </td>
                <td>
                    <textarea name="description" form="edit-{{ item.id }}" rows="2">{{ item.description }}</textarea>
                </td>
                <td class="actions">
                    <form method="post" action="{{ url_for('products_update', product_id=item.id) }}" id="edit-{{ item.id }}" class="inline-form"></form>
                    <button type="submit" form="edit-{{ item.id }}" class="btn-primary">ุฐุฎุฑู</button>
                    <form method="post" action="{{ url_for('products_delete', product_id=item.id) }}" class="inline-form" onsubmit="return confirm('ุญุฐู ุงู ููุฑุฏุ ุฒุฑูุฌููุนูโูุง ูุฒ ุญุฐู ูโุดููุฏ.');">
                        <button type="submit" class="btn-danger">ุญุฐู</button>
                    </form>
                </td>
            </tr>
            {% else %}
            <tr><td colspan="6" class="empty">ูููุฒ ูุญุตูู ุซุจุช ูุดุฏู ุงุณุช.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</section>
{% endblock %}
