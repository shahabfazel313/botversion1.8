{% extends 'base.html' %}
{% block content %}
<h1>ูุฏุฑุช ูุญุตููุงุช</h1>

<section class="panel">
    <header>
        <h2>ุงุฌุงุฏ ุฏุณุชู ุฌุฏุฏ</h2>
        <p class="muted">ุฏุณุชูโูุง ููุท ุจุฑุง ฺุฏูุงู ูุณุชูุฏ ู ููุดู ูุนุงู ูโูุงููุฏ.</p>
    </header>
    <form method="post" action="{{ url_for('products_create') }}" class="grid form-grid">
        <input type="hidden" name="type" value="category">
        <label>
            ูุงู ุฏุณุชู
            <input type="text" name="title" required placeholder="ูุซูุงู ุฎุฏูุงุช ุฌุฏุฏ">
        </label>
        <label>
            ุชุฑุชุจ ููุงุด
            <input type="number" name="sort_order" value="0" min="0">
        </label>
        <div class="form-actions">
            <button type="submit" class="btn-primary">ุงุฌุงุฏ ุฏุณุชู</button>
        </div>
    </form>
</section>

<section class="panel">
    <header>
        <h2>ุงุฌุงุฏ ูุญุตูู/ุฎุฏูุช ุฌุฏุฏ</h2>
        <p class="muted">ูุญุตููุงุช ูโุชูุงููุฏ ุฏุฑุฎูุงุณุชโูุญูุฑ ุง ุฏุงุฑุง ุญุงูุช ุงฺฉุงูุช ุจุงุดูุฏ.</p>
    </header>
    <form method="post" action="{{ url_for('products_create') }}" class="grid form-grid">
        <input type="hidden" name="type" value="product">
        <label>
            ูุงู ูุญุตูู
            <input type="text" name="title" required placeholder="ูุซูุงู ุณุฑูุณ ุฌุฏุฏ">
        </label>
        <label>
            ูุงูุฏ (ููุท ุฏุณุชู)
            <select name="parent_id">
                {% for p in parents %}
                <option value="{{ p.id }}">{{ p.title }}</option>
                {% endfor %}
            </select>
        </label>
        <label>
            ุชุฑุชุจ ููุงุด
            <input type="number" name="sort_order" value="0" min="0">
        </label>
        <label>
            ููุช ูพุงู ({{ currency }})
            <input type="number" name="price" value="0" min="0" step="1000">
        </label>
        <label class="checkbox">
            <input type="checkbox" name="available" checked>
            ููุฌูุฏ ุจุงุดุฏ
        </label>
        <label class="checkbox">
            <input type="checkbox" name="request_only">
            ููุท ุซุจุช ุฏุฑุฎูุงุณุช (ุจุฏูู ููุช)
        </label>
        <label class="checkbox">
            <input type="checkbox" name="account_enabled">
            ุฏุงุฑุง ุงูุชุฎุงุจ ุงฺฉุงูุช ุจุงุดุฏ
        </label>
        <div class="inline-fields span">
            <label class="checkbox">
                <input type="checkbox" name="self_available">
                ุฑู ุงฺฉุงูุช ุฎูุฏู ูุนุงู ุจุงุดุฏ
            </label>
            <label>
                ููุช ุฑู ุงฺฉุงูุช ุฎูุฏู
                <input type="number" name="self_price" value="0" min="0" step="1000">
            </label>
            <label class="checkbox">
                <input type="checkbox" name="pre_available">
                ุงฺฉุงูุช ุงุฒ ูพุด ุณุงุฎุชู ุดุฏู ูุนุงู ุจุงุดุฏ
            </label>
            <label>
                ููุช ุงฺฉุงูุช ุขูุงุฏู
                <input type="number" name="pre_price" value="0" min="0" step="1000">
            </label>
        </div>
        <div class="inline-fields span">
            <label class="checkbox">
                <input type="checkbox" name="require_username">
                ฺฏุฑูุชู ูุฒุฑ
            </label>
            <label class="checkbox">
                <input type="checkbox" name="require_password">
                ฺฏุฑูุชู ูพุณูุฑุฏ
            </label>
        </div>
        <label class="full">
            ุชูุถุญุงุช
            <textarea name="description" rows="2" placeholder="ุชูุถุญ ฺฉูุชุงู ุจุฑุง ุตูุญูู ูุญุตูู"></textarea>
        </label>
        <div class="form-actions">
            <button type="submit" class="btn-primary">ุงุฌุงุฏ ูุญุตูู</button>
        </div>
    </form>
</section>

<section class="panel">
    <header>
        <h2>ููุฑุณุช ฺฉุงูู ูุญุตููุงุช ู ุฏุณุชูโูุง</h2>
        <p class="muted">ููุชโูุง ุจุฑ ุญุณุจ {{ currency }} ูุณุชูุฏ. ูุฑ ุฑุฏู ูุงุจู ูุฑุงุด ูุณุชูู ุงุณุช.</p>
    </header>
    <form method="post" action="{{ url_for('products_bulk_update') }}" id="bulk-form">
        <table class="products-table">
            <thead>
                <tr>
                    <th>ุนููุงู</th>
                    <th>ฺุฏูุงู</th>
                    <th>ฺฏุฒููโูุง</th>
                    <th>ูุงูุฏ</th>
                    <th>ุชูุถุญุงุช</th>
                    <th>ุนููุงุช</th>
                </tr>
            </thead>
            <tbody>
                {% for item in products %}
                <tr>
                    <td>
                        <div class="tree-title" style="--depth: {{ item.depth }};">
                            <span class="node-tag {{ 'category' if item.is_category else 'product' }}">{{ '๐' if item.is_category else '๐๏ธ' }}</span>
                            <input type="hidden" name="is_category-{{ item.id }}" value="{{ 1 if item.is_category else 0 }}">
                            <input type="text" name="title-{{ item.id }}" value="{{ item.title }}" required>
                            <div class="path muted">{{ item.path_display }}</div>
                        </div>
                    </td>
                    <td>
                        <div class="inline-fields">
                            <label>
                                ุชุฑุชุจ
                                <input type="number" name="sort_order-{{ item.id }}" value="{{ item.sort_order or 0 }}" min="0">
                            </label>
                            <p class="muted">ููุน: {{ 'ุฏุณุชู' if item.is_category else 'ูุญุตูู' }}</p>
                        </div>
                    </td>
                    <td>
                        <div class="stack">
                            <div class="inline-fields">
                                <label>ููุช ูพุงู
                                    <input type="number" name="price-{{ item.id }}" value="{{ item.price }}" min="0" step="1000" {% if item.is_category %}disabled{% endif %}>
                                </label>
                                <label class="checkbox">
                                    <input type="checkbox" name="available-{{ item.id }}" {% if item.available %}checked{% endif %} {% if item.is_category %}disabled{% endif %}>
                                    ูุนุงู
                                </label>
                            </div>
                            {% if not item.is_category %}
                            <div class="inline-fields">
                                <label class="checkbox">
                                    <input type="checkbox" name="request_only-{{ item.id }}" {% if item.request_only %}checked{% endif %}>
                                    ููุท ุซุจุช ุฏุฑุฎูุงุณุช
                                </label>
                                <label class="checkbox">
                                    <input type="checkbox" name="account_enabled-{{ item.id }}" {% if item.account_enabled %}checked{% endif %}>
                                    ุงูุชุฎุงุจ ุงฺฉุงูุช
                                </label>
                            </div>
                            <div class="inline-fields">
                                <label class="checkbox">
                                    <input type="checkbox" name="self_available-{{ item.id }}" {% if item.self_available %}checked{% endif %}>
                                    ุฑู ุงฺฉุงูุช ุฎูุฏู
                                </label>
                                <label>
                                    ููุช ุฎูุฏู
                                    <input type="number" name="self_price-{{ item.id }}" value="{{ item.self_price }}" min="0" step="1000">
                                </label>
                                <label class="checkbox">
                                    <input type="checkbox" name="pre_available-{{ item.id }}" {% if item.pre_available %}checked{% endif %}>
                                    ุงฺฉุงูุช ุขูุงุฏู
                                </label>
                                <label>
                                    ููุช ุขูุงุฏู
                                    <input type="number" name="pre_price-{{ item.id }}" value="{{ item.pre_price }}" min="0" step="1000">
                                </label>
                            </div>
                            <div class="inline-fields">
                                <label class="checkbox">
                                    <input type="checkbox" name="require_username-{{ item.id }}" {% if item.require_username %}checked{% endif %}>
                                    ฺฏุฑูุชู ูุฒุฑ
                                </label>
                                <label class="checkbox">
                                    <input type="checkbox" name="require_password-{{ item.id }}" {% if item.require_password %}checked{% endif %}>
                                    ฺฏุฑูุชู ูพุณูุฑุฏ
                                </label>
                            </div>
                            {% endif %}
                        </div>
                    </td>
                    <td>
                        {% if item.is_category %}
                        <p class="muted">โ</p>
                        {% else %}
                        <select name="parent_id-{{ item.id }}">
                            {% for p in parents %}
                            <option value="{{ p.id }}" {% if (item.parent_id or 0) == p.id %}selected{% endif %}>{{ p.title }}</option>
                            {% endfor %}
                        </select>
                        {% endif %}
                    </td>
                    <td>
                        <textarea name="description-{{ item.id }}" rows="2">{{ item.description }}</textarea>
                    </td>
                    <td class="actions">
                        <button type="submit" class="btn-danger" formnovalidate formaction="{{ url_for('products_delete', product_id=item.id) }}" onclick="return confirm('ุญุฐู ุงู ููุฑุฏุ ุฒุฑูุฌููุนูโูุง ูุฒ ุญุฐู ูโุดููุฏ.');">ุญุฐู</button>
                    </td>
                </tr>
                {% else %}
                <tr><td colspan="6" class="empty">ูููุฒ ูุญุตูู ุซุจุช ูุดุฏู ุงุณุช.</td></tr>
                {% endfor %}
            </tbody>
        </table>
        <div class="form-actions">
            <button type="submit" class="btn-primary">ุชุงุฏ ฺฉู</button>
        </div>
    </form>
</section>
{% endblock %}
